<!DOCTYPE html>
<html>
  <head>
    <title>NewKL : 게시판</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="UTF-8" />

    <link rel="icon" href="./favicon.ico" type="image/x-icon" />
    <!-- ajax -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  </head>
  <style>
    button {
      background-color: #f9b514;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
  <script>
    const queryString = window.location.search
    const urlParams = new URLSearchParams(queryString)
    const board_id = urlParams.get('boardId')

    let standardPSWD = ''

    $(document).ready(function () {
      showArticle(board_id)
    })

    function showArticle(board_id) {
      $.ajax({
        type: 'POST',
        url: 'api/board/article',
        data: {
          board_id,
        },
        success: function (res) {
          if (res.success) {
            let board_id = res.rows[0].BOARD_ID
            let title = res.rows[0].TITLE
            let writer = res.rows[0].WRITER
            let contents = res.rows[0].CONTENTS
            let regDate = res.rows[0].REG_DATE
            let comment = res.rows[0].COMMENT_ID
            let email = res.rows[0].EMAIL
            let phone_number = res.rows[0].PHONE_NUMBER
            standardPSWD = res.rows[0].PSWD
            let splitRegDate = regDate.split(' ')[0]

            let temp_html = `
                <hr>
                <p> 이름: ${writer} </p>
                <p> 이메일: ${email} </p>
                <p> 전화번호: ${phone_number} </p>
                <p> 제목: ${title} </p>
                <p> 작성일자: ${splitRegDate} </p>
                <p> 내용: ${contents} </p>
                <hr>
                ${comment ? `<p> 답변: ${comment} </p> <hr>` : ''}
                                    `
            $('#article').append(temp_html)
          }
        },
        error: function (err) {
          console.log(err)
        },
      })
    }

    function goTo(num) {
      let confirmMsg = ''
      let confirmUrl = ''
      if (num === 1) {
        confirmMsg = '수정페이지로 이동합니다.'
        confirmUrl = `/write.html?boardId=${board_id}`
      } else if (num === 2) {
        confirmMsg = '정말로 삭제하시겠습니까?'
        confirmUrl = '/board.html'
      } else if (num === 3) {
        confirmMsg = '전체 글 목록으로 이동합니다.'
        confirmUrl = '/board.html'
      } else {
        confirmMsg = '작성페이지로 이동합니다.'
        confirmUrl = '/write.html'
      }

      var confirmResult = confirm(`${confirmMsg}`)
      if (confirmResult) {
        window.location.href = `${confirmUrl}`
      }
    }
  </script>

  <body>
    <div id="article"></div>
    <button id="" onclick="goTo(1)">수정</button>
    <button id="" onclick="goTo(2)">삭제</button>
    <button id="" onclick="goTo(3)">목록</button>
    <button id="" onclick="goTo(4)">글쓰기</button>
  </body>
</html>
